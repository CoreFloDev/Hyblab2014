<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test dataviz</title>
    <link rel="stylesheet" href="css/foundation.css" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/style-carte.css" />
    <script src="js/vendor/modernizr.js"></script>
    <script src="js/vendor/jquery.js"></script>
    <script src="js/foundation/foundation.js"></script>
    <script src="js/foundation/foundation.dropdown.js"></script>
    <script src="js/foundation/foundation.tooltip.js"></script>
    <script src="js/foundation/foundation.magellan.js"></script>
    <!-- Partie du fait maison -->
    <script src="js/vendor/round-chart.js"></script>
    <script src="js/vendor/maps-france.js"></script>
    <script src="js/csv-match.js"></script>
  </head>
  <body>
  
   <nav>
      <a href="#page1"><img data-tooltip class="has-tip tip-right" title="début" src="img/ptvide.svg"/></a><br>
      <a data-tooltip class="has-tip tip-right" title="début" href="#page2"><img src="img/ptvide.svg"/></a><br>
      <a data-tooltip class="has-tip tip-right" title="début"><img src="img/ptvide.svg"/></a><br>
      <a data-tooltip class="has-tip tip-right" title="début"><img src="img/ptvide.svg"/></a><br>
      <a data-tooltip class="has-tip tip-right" title="début"><img src="img/ptvide.svg"/></a><br>
      <a data-tooltip class="has-tip tip-right" title="début"><img src="img/ptvide.svg"/></a><br>
      <a data-tooltip class="has-tip tip-right" title="début"><img src="img/ptvide.svg"/></a><br>
      <a data-tooltip class="has-tip tip-right" title="début"><img src="img/ptvide.svg"/></a><br>
      <a data-magellan-destination="page9" data-tooltip class="has-tip tip-right" title="a"><img src="img/ptvide.svg"/></a>
   </nav>

   <div id="page1" class="page row bg-green">
      <div class="columns small-12 large-12 columns">
         <div id="main-title">
            <h1 class="title">open data</h1>
            <h3 class="title">où en est l'ouest ?</h3>
         </div>
      </div>
   </div>
   
   
   <div id="page2" class="page row bg-blue">
      <h2 class="title">l'open data en question</h2>
      
      <div class="small-12 medium-8 medium-centered large-8 large-centered columns">
         <div class="flex-video">
            <iframe src="//www.youtube.com/embed/p5xJKl-wBiU" width="420" height="315"  frameborder="0" allowfullscreen></iframe>
         </div>
      </div>
   </div>
   
   <div id="page3" class="page row bg-gray">
      <h2 class="title">l'open data en France</h2>
      <div class="small-12 medium-9 large-9 columns" id="carteDeFrance">
         <img src="img/carte-France-page3.svg" alt="maps of France"/>
      </div>
      <div class="small-12 medium-3 large-3 columns" id="side-page3">
         <p>Cliquer sur la ville pour obtenir plus d'information</p>
         <ul class="small-block-grid-2 medium-block-grid-1 large-block-grid-1">
            <li>
               <img src="img/pictogramme-nombre-d-habitant-page3.svg" alt="picture face of one people"/><br/>
               <span id="picto-nb-hab">0</span> habitants
            </li>
            <li>
               <img src="img/pictogramme-jeux-de-donnees-page3.svg" alt="chart"/><br/>
               <span id="picto-nb-jeux-donnees">0</span> jeux de données
            </li>
            <li>
               <img src="img/pictogramme-nombre-de-donnees-par-habitants-page3.svg" alt="two arrow"/><br/>
               <span id="picto-ratio-hab">0</span> jeux de données pour 100 000 habitant
            </li>
            <li>
               <img src="img/pictogramme-thematique-des jeux-de-donnees-page3.svg" alt="house with two tree"/><br/>
               <span id="picto-nb-hab">thématiques des jeux de données</span>
            </li>
         </ul>
      </div>
   </div>
   
   <div id="page4" class="page row bg-red">
      <div class="small-12 medium-11 medium-centered large-11 large-centered columns">
         <div class="row">
            <div class="small-12 medium-6 large-6 columns">
               <h2 class="title">nombre de jeux de données</h2>
               <div class="graphique" id="nb-jeux-donnees">
                  <div class="villes" id="ville-jdd">
                  </div>
               </div>
               <img src="img/ombre.svg" alt="shadow" class="shadow-page4 show-for-medium-up"/>
            </div>
            <div class="small-12 medium-6 large-6 columns">
               <h2 class="title">ratio de données pour 100 000 habitants</h2>
               <div class="graphique" id="ratio-jeux-donnees">
                  <div class="villes" id="ville-ratio">
                  </div>
               </div>
               <img src="img/ombre.svg" alt="shadow" class="shadow-page4 show-for-medium-up"/>
            </div>
         </div>
      </div>
   </div>
   
   <div id="page5" class="page row bg-gray">
      <h2 class="title">thématiques des jeux de données</h2>

      <div class="small-12 medium-12 large-12 columns">
		
		   <table id="tableau-match" width="100%">
		   <tr>
			   <td id="nomVille1" align="right" style="width:41%"></td>
			   <td align="middle" style="width:18%"></td>
			   <td Id="nomVille2" align="left" style="width:41%"></td>
		   </tr>
		   </table>

		   <img src="img/ombre-plate.svg" alt="shadow" class="shadow-page5 show-for-medium-up"/>
		</div>
	</div>
   
   <div id="page6" class="page row bg-blue">
      <h1 class="title">et l'ouest ?<h1>
   </div>
   
   <div id="page7" class="page row bg-green">

		<div class="small-12 large-6 medium-6 columns">
		   	<H4 id="nomdepartementselection" style="middle"></H4>
	   	 	<div id="infodepartementselection" style="middle"></div>
			<div style="position:relative">
				<div style="position:absolute; top:4%; left:20%; ">
					<img src="img/trait.svg" width="20px" >
					<div style="position:absolute; top:0%; left:30%; ">
					info
				</div>
				</div>
				
				<img id="departementselection" src="img/cotearmor.svg" width="50%" height="50%"/>
				<div id="infovilledepartementselection" style="middle"></div>
			</div>
		
		</div>

		
		<div class="small-12 large-6 medium-6 columns">
			<H4> GRAND OUEST</H4>
			<div class="map">
			<img src="img/vide.png" width="362" height="248" border="0" usemap="#mapouest" />


			<map name="mapouest">
			<area id="dep-1" shape="poly" coords="23,208,40,119,112,86,243,56,289,79,294,60,353,82,355,272,305,298,319,358,382,369,386,395,338,421,340,471,318,445,253,425,236,408,173,401,173,420,107,419,122,383,21,309,23,289,150,291,135,253,84,244,76,205,127,209,120,162" onclick="loadimageouest(0)" />
			<area  id="dep-2" shape="poly" coords="354,272,433,308,483,269,577,312,678,311,678,373,718,383,738,437,699,471,728,522,716,567,675,565,643,594,619,592,604,571,524,577,545,546,526,519,492,534,451,535,448,571,428,558,433,519,384,470,339,472,337,419,387,390,383,370,318,357,305,299,352,273" onclick="loadimageouest(1)" />
			<area  id="dep-3" shape="poly" coords="356,272,353,80,378,26,401,32,486,15,560,123,600,144,679,108,725,162,730,127,789,165,777,218,677,311,571,307,482,271,433,310,358,273" onclick="loadimageouest(2)" />
			<area  id="dep-4" shape="poly" coords="788,162,777,221,674,316,678,373,719,379,742,433,704,468,727,523,846,495,900,455,951,435,970,400,1010,391,1015,190,969,163,925,194,899,130,831,151,804,129,811,106,764,117,765,151,783,160" onclick="loadimageouest(3)" />
			<area  id="dep-5" shape="poly" coords="727,522,711,566,671,566,643,594,716,620,703,663,767,694,826,751,872,750,860,709,874,693,896,736,910,717,909,698,978,691,945,672,954,639,919,601,949,582,1020,592,1005,514,966,480,953,433,851,495,747,518" onclick="loadimageouest(4)" />
			<area  id="dep-6" shape="poly" coords="765,695,725,728,690,696,681,710,715,748,702,764,786,842,786,895,943,963,996,934,1002,946,1020,942,1063,960,1092,939,1071,921,1069,886,1094,849,1069,786,1022,720,946,696,911,696,910,720,894,735,877,697,862,710,875,750,822,750,809,732" onclick="loadimageouest(5)" />
			<area  id="dep-7" shape="poly" coords="921,603,952,634,948,670,971,691,943,693,1017,720,1030,735,1051,726,1097,723,1099,705,1124,696,1200,693,1214,704,1231,696,1301,541,1297,522,1157,452,1021,435,1020,454,957,437,964,481,1006,513,1019,591,959,581,942,588" onclick="loadimageouest(6)" />
			<area  id="dep-8" shape="poly" coords="1012,189,1014,393,977,402,952,433,1017,454,1021,435,1157,449,1213,296,1207,250,1246,239,1246,220,1192,179,1074,209,1066,188,1033,189" onclick="loadimageouest(7)" />
			<area  id="dep-9" shape="poly" coords="1158,451,1295,519,1333,526,1453,397,1453,324,1420,296,1392,293,1345,260,1338,258,1338,218,1314,205,1268,237,1210,251,1215,289,1183,377" onclick="loadimageouest(8)" />
			</map>

			<script src="js/carteouest.js"></script>
			</div>
		</div>

	</div>
   
   <div id="page8" class="page row bg-red">
      <h2 class="title">interviews</h2>
      
      <div class="small-12 medium-8 medium-centered large-8 large-centered columns">
         <div class="flex-video">
            <iframe src="//www.youtube.com/embed/Qu6SuzxMWNM" width="420" height="315"  frameborder="0" allowfullscreen></iframe>
         </div>
         <p>
            Claire Gallon, cofondatrice de l'association LiberTIC qui promeut l'ouverture des données en France, revient sur le mouvement Open data dans l'Ouest.
         </p>
      </div>
   </div>
   
   <div data-magellan-destination="page9" id="page9" class="page row bg-blue">
   
      <h2 class="title">l'open data en application</h2>
      <div class="small-12 medium-5 large-5 columns">
         <a href="http://www.rengo.fr/rennes/">
            <img src="img/logo_rengo.png" alt="rengo logo"/>
         </a>
         <p>
            application mobile gratuite qui indique en temps réel les horaires et disponibilités de nombreux services de transports rennais (trains, bus, vélos, parkings, etc.). Cette application est également disponible pour les villes de Nantes, Bordeaux, Strasbourg...
         </p>
         
         <a href="https://play.google.com/store/apps/details?id=net.naonedbus&hl=fr">
            <img src="img/logo_naonedbus.png" alt="naoned bus logo"/>
         </a>
         <p>
            application mobile gratuite pour Android permettant de consulter les horaires des transports nantais (réseau Tan, disponibilité des bicloos et parkings de la ville).
         </p>
      </div>
      <div class="large-2 medium-2 columns">
      </div>
      <div class="small-12 medium-5 large-5 columns">
      
         <a href="http://foglo.fr">
            <img src="img/logo_foglo.png" alt="foglo logo"/>
         </a>
         <p>
            application web gratuite qui fournit aux utilisateurs un tableau de bord regroupant divers services (météo, Tan, parkings, qualité de l'air, twitter, facebook, rss, ...).
         </p>

         <a href="http://www.handimap.org/">
            <img src="img/logo_handimap.png" alt="handimap.org logo"/>
         </a>
         <p>
            application web gratuite qui permet de calculer des itinéraires accessibles aux personnes à mobilité réduite dans la ville de Rennes (ainsi que Montpellier).
         </p>
      </div>
   </div>
   
   <footer class="row bg-gray">
      <div class="small-12 medium-2 large-2 columns">
         <a href="https://twitter.com/terristoires" ><img src="img/twitter.svg" alt="twitter logo" class="logo-social-footer logo-social-facebook-footer"/></a>
         <a href="https://www.facebook.com/terristoires.info" ><img src="img/facebook.svg" alt="facebook logo" class="logo-social-footer logo-social-twitter-footer"/></a>
      </div>
      
      <div class="small-12 medium-8 large-8 columns">
         <p class="content-footer">
         &copy; Nom prénom etc..
         </p>
      </div>
      
      <div class="small-12 medium-2 large-2 columns">
         <img src="img/footer-car.svg" alt="flying car" class="logo-car-footer"/>
      </div>
   
   </footer>
   
   <div style="display:none;">
      <a href="#" data-dropdown="drop" class="button dropdown">Dropdown Button</a><br> <ul id="drop" data-dropdown-content class="f-dropdown"> <li><a href="#">This is a link</a></li> <li><a href="#">This is another</a></li> <li><a href="#">Yet another</a></li> </ul>
      <span data-tooltip class="has-tip" title="Tooltips are awesome, you should totally use them!">extended information</span>
   </div>
  
  <script type="text/javascript"> 
  $(document).foundation({
     // specify the class used for active divs
     active_class: 'active',
     // how many pixels until the magellan bar sticks, 0 = auto
     threshold: 0,
     // pixels from the top of destination for it to be considered active
     destination_threshold: 20,
     // calculation throttling to increase framerate
     throttle_delay: 50,
     tooltips: {
      touch_close_text: 'appuyer pour fermer'
     }
  });
  
   // chargement des données pour la carte de france
   var map = new MapsFrance('#carteDeFrance');
   var page3Loaded =false;
   $('#page3').hover(function(){
      if(!page3Loaded) {
         page3Loaded = true;
         $.getJSON( "data/villes.json", function( dataVille ) {
            for(i=0;i<dataVille.length;i++) {
               map.addPoint(dataVille[i].latitude,dataVille[i].longitude,dataVille[i].nom);
            }
         });
      }
   },function() {});
   
   // chargement des diagrammes circulaires
   nbJeuxDonnees = new CanvasRenderer(document.getElementById('nb-jeux-donnees'));
   ratioJeuxDonnees = new CanvasRenderer(document.getElementById('ratio-jeux-donnees'));

   var dataGraph1 = new Object();
   var dataGraph2 = new Object();
   
   var choixVillesGraph = ["Nantes","Rennes","Paris","Bordeaux"];
   
   var page4Loaded = false;
   
   $('#page4').hover(function(){
      if(!page4Loaded) {
         page4Loaded = true;
         $.getJSON( "data/villes.json", function( data ) {
         
            nombreJeux = new Array();
            ratios = new Array();
            for(i=0;i<data.length;i++) {
               var position = $.inArray(data[i].nom,choixVillesGraph);
               if(position != -1){
                  nombreJeux[choixVillesGraph[position]] = data[i].jeuxDeDonnees;
                  var ratio = (Math.round(data[i].jeuxDeDonnees/data[i].population*100000*100))/100;
                  ratios[choixVillesGraph[position]] = ratio;
               }
            }
            
            // écriture des villes
            for(i=0;i<choixVillesGraph.length;i++) {
               $('#ville-jdd').append('<span class="ville">'+choixVillesGraph[i]+'</span> '+nombreJeux[choixVillesGraph[i]]+'<br>');
            }
            
            for(i=0;i<choixVillesGraph.length;i++) {
               $('#ville-ratio').append('<span class="ville">'+choixVillesGraph[i]+'</span> '+ratios[choixVillesGraph[i]]+'<br>');
            }
            
            
            // recherche des max
            maxNomJeux = 0;
            indiceMaxNomJeux = 0;
            maxRatios = 0;
            indiceMaxRatios = 0;
            for(i=0;i<choixVillesGraph.length;i++) {
               if(maxNomJeux < nombreJeux[choixVillesGraph[i]]) {
                  maxNomJeux = nombreJeux[choixVillesGraph[i]];
                  indiceMaxNomJeux = i;
               }
               if(maxRatios < ratios[choixVillesGraph[i]]) {
                  maxRatios = ratios[choixVillesGraph[i]];
                  indiceMaxRatios = i;
               }
            }
            
            // calcul des pourcentages
            dataGraph1.greenLine = nombreJeux[choixVillesGraph[0]]*100/nombreJeux[choixVillesGraph[indiceMaxNomJeux]];
            dataGraph1.whiteLine = nombreJeux[choixVillesGraph[1]]*100/nombreJeux[choixVillesGraph[indiceMaxNomJeux]];
            dataGraph1.redLine = nombreJeux[choixVillesGraph[2]]*100/nombreJeux[choixVillesGraph[indiceMaxNomJeux]];
            dataGraph1.yellowLine = nombreJeux[choixVillesGraph[3]]*100/nombreJeux[choixVillesGraph[indiceMaxNomJeux]];
            
            // graph 2
            dataGraph2.greenLine = ratios[choixVillesGraph[0]]*100/ratios[choixVillesGraph[indiceMaxRatios]];
            dataGraph2.whiteLine = ratios[choixVillesGraph[1]]*100/ratios[choixVillesGraph[indiceMaxRatios]];
            dataGraph2.redLine = ratios[choixVillesGraph[2]]*100/ratios[choixVillesGraph[indiceMaxRatios]];
            dataGraph2.yellowLine = ratios[choixVillesGraph[3]]*100/ratios[choixVillesGraph[indiceMaxRatios]];
            
            // animation
            nbJeuxDonnees.animate(dataGraph1);
            ratioJeuxDonnees.animate(dataGraph2);
         });
         
      }
   
   },function() {});
   
   
   // chargement de la liste des villes
   $.ajax( "data/theme.csv" )
   .done(function(csv) {
      montab = csv2array(csv);
      genererdataviz(montab, 1, 2);
   });
   
  </script>
  </body>
</html>
