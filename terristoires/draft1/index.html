<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test dataviz</title>
    <link rel="stylesheet" href="css/foundation.css" />
    <link rel="stylesheet" href="css/style.css" />
    <script src="js/vendor/modernizr.js"></script>
    <script src="js/vendor/jquery.js"></script>
    <script src="js/foundation/foundation.js"></script>
    <script src="js/foundation/foundation.dropdown.js"></script>
    <script src="js/foundation/foundation.tooltip.js"></script>
    <!-- Partie du fait maison -->
    <script src="js/vendor/round-chart.js"></script>
    <script src="js/vendor/maps-france.js"></script>
    <script src="js/csv-match.js"></script>
  </head>
  <body>
  
  <!--
  save
/*{'nom':'Brest','latitude':48.390394,'longitude':-4.1,'population':,'jeuxDeDonnees':},*/
/*{'nom':'Strasbourg','latitude':48.583148,'longitude':7.3},*/
/*{'nom':'Le Mans','latitude':48.006110000001,'longitude':0.1995560000000296},*/
/*{'nom':'Lille','latitude':50.62925,'longitude':2.5},*/
/*{'nom':'Toulouse','latitude':43.604652,'longitude':1.4442090000000007},*/
/*{'nom':'Montpellier','latitude':43.610769,'longitude':3.8767159999999876},*/
/*{'nom':'Angers','latitude':47.478419,'longitude':-0.5631660000000238}*/
  -->

   <div id="page1" class="page row bg-green">
      <div class="columns small-12 large-12 columns">
         <h1 class="title">open data</h1>
         <h3 class="title">ou en est l'ouest ?</h3>
      </div>
   </div>
   
   
   <div id="page2" class="page row bg-blue">
      <h2 class="title">l'open data en question</h2>
      
      <div class="small-12 medium-10 medium-centered large-10 large-centered columns">
         <div class="flex-video">
            <!--
            <iframe src="//www.youtube.com/embed/p5xJKl-wBiU" width="420" height="315"  frameborder="0" allowfullscreen></iframe>
            -->
         </div>
      </div>
   </div>
   
   <div id="page3" class="page row bg-gray">
      <div class="small-12 medium-10 large-10 large-centered medium-centered columns">
         <h2 class="title">l'open data en France</h2>
         <div class="row">
            <div class="small-12 medium-10 large-10 large-centered medium-centered columns" id="carteDeFrance">
               <img src="img/carte-France-page3.svg" alt="maps of France"/>
            </div>
         </div>
         <div class="row">
            <div class="small-12 medium-10 large-10 large-centered medium-centered columns">
               <ul class="small-block-grid-2 medium-block-grid-4 large-block-grid-4">
                  <li>
                     <img src="img/pictogramme-nombre-d-habitant-page3.svg" alt="picture face of one people"/>
                     <span id="picto-nb-hab">0</span> habitants
                  </li>
                  <li>
                     <img src="img/pictogramme-jeux-de-donnees-page3.svg" alt="chart"/>
                     <span id="picto-nb-jeux-donnees">0</span> jeux de données
                  </li>
                  <li>
                     <img src="img/pictogramme-nombre-de-donnees-par-habitants-page3.svg" alt="two arrow"/>
                     <span id="picto-ratio-hab">0</span> jeux de données par habitant (x100000)
                  </li>
                  <li>
                     <img src="img/pictogramme-thematique-des jeux-de-donnees-page3.svg" alt="house with two tree"/>
                     <span id="picto-nb-hab">thématiques des jeux de données</span>
                  </li>
               </ul>
            </div>
         </div>
      </div>
   </div>
   
   <div id="page4" class="page row bg-red">
      <div class="small-12 medium-11 medium-centered large-11 large-centered columns">
         <div class="row">
            <div class="small-12 medium-6 large-6 columns">
               <h2 class="title">nombre de jeux de données</h2>
               <div class="graphique" id="nb-jeux-donnees">
                  <div class="villes">
                     <span class="ville">nantes</span><br/>
                     <span class="ville">rennes</span><br/>
                     <span class="ville">paris</span><br/>
                     <span class="ville">bordeau</span>
                  </div>
               </div>
               <img src="img/ombre.svg" alt="shadow" class="shadow-page4 show-for-medium-up"/>
            </div>
            <div class="small-12 medium-6 large-6 columns">
               <h2 class="title">radio de données par habitants (x100000)</h2>
               <div class="graphique" id="ratio-jeux-donnees">
                  <div class="villes">
                     <span class="ville">nantes</span><br/>
                     <span class="ville">rennes</span><br/>
                     <span class="ville">paris</span><br/>
                     <span class="ville">bordeau</span>
                  </div>
               </div>
               <img src="img/ombre.svg" alt="shadow" class="shadow-page4 show-for-medium-up"/>
            </div>
         </div>
      </div>
   </div>
   
   <div id="page5" class="page row bg-gray">
      <h2 class="title">thématique des jeux de données</h2>

      <div class="small-12 medium-12 large-12 columns">
		
		   <table id="tableau-match" width="100%">
		   <tr>
			   <td id="nomVille1" align="right" style="width:45%"></td>
			   <td align="middle" style="width:10%"></td>
			   <td Id="nomVille2" align="left" style="width:45%"></td>
		   </tr>
		   </table>

		   <img src="img/ombre-plate.svg" alt="shadow" class="shadow-page5 show-for-medium-up"/>
		</div>
	</div>
   
   <div id="page6" class="page row bg-blue">
      <h1 class="title">et l'ouest ?<h1>
   </div>
   
   <div id="page7" class="page row bg-green">
   </div>
   
   <div id="page8" class="page row bg-red">
      <h2 class="title">interviews</h2>
      
      <div class="small-12 medium-10 medium-centered large-10 large-centered columns">
         <div class="flex-video">
            <!--
            <iframe src="//www.youtube.com/embed/Qu6SuzxMWNM" width="420" height="315"  frameborder="0" allowfullscreen></iframe>
            -->
         </div>
         <p>
            <img src="img/facebook.svg" alt="face"/>
            Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim. Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo. Nullam dictum felis eu pede mollis pretium. Integer tincidunt. Cras dapibus. Vivamus elementum semper nisi. Aenean vulputate eleifend tellus. Aenean leo ligula, porttitor eu, consequat vitae, eleifend ac, enim. Aliquam lorem ante, dapibus in, viverra quis, feugiat a, tellus. Phasellus viverra nulla ut metus varius laoreet. Quisque rutrum. Aenean imperdiet. Etiam ultricies nisi vel augue. Curabitur ullamcorper ultricies nisi. Nam eget dui. Etiam rhoncus. Maecenas tempus, tellus eget condimentum rhoncus, sem quam semper libero, sit amet adipiscing sem neque sed ipsum. Nam quam nunc, blandit vel, luctus pulvinar, hendrerit id, lorem. Maecenas nec odio et ante tincidunt tempus. Donec vitae sapien ut libero venenatis faucibus. Nullam quis ante. Etiam sit amet orci eget eros faucibus tincidunt. Duis leo. Sed fringilla mauris sit amet nibh. Donec sodales sagittis magna. Sed consequat, leo eget bibendum sodales, augue velit cursus nunc, 
         </p>
      </div>
   </div>
   
   <div id="page9" class="page row bg-blue">
   
      <h2 class="title">l'open data en application</h2>
      <div class="small-12 medium-5 large-5 columns">
         <a href="http://nanteslive.fr/">
            <img src="img/logo_nanteslive.png" alt="nantes live logo"/>
         </a>
         <p>
            application mobile gratuite pour iPhone et tablette iPad qui regroupe les actualités, vidéos et services pratiques nantais, en temps réel.
         </p>
         
         <a href="http://www.rengo.fr/rennes/">
            <img src="img/logo_rengo.png" alt="rengo logo"/>
         </a>
         <p>
            application mobile gratuite qui indique en temps réel, les horaires et disponibilités de nombreux services de transports rennais (trains, bus, vélos, parkings, etc.). Cette application est également disponible pour les villes de Nantes, Bordeaux, Strasbourg...
         </p>
      </div>
      <div class="large-2 medium-2 columns">
      </div>
      <div class="small-12 medium-5 large-5 columns">
         <a href="http://www.handimap.org/">
            <img src="img/logo_handimap.png" alt="handimap.org logo"/>
         </a>
         <p>
            application web gratuite qui permet de calculer des itinéraires accessibles aux personnes à mobilité réduite dans la ville de Rennes (ainsi que Montpellier).
         </p>
         
         <a href="http://www.greenraid.fr/">
            <img src="img/logo_greenraid.png" alt="green raid logo"/>
         </a>
         <p>
            application mobile et web gratuite, qui permet de trouver autour de soi des lieux et des infos correspondant à un mode de vie locale et durable.
         </p>
      </div>
   </div>
   
   <footer class="row bg-gray">
      <div class="small-12 medium-2 large-2 columns">
         <a href="https://twitter.com/terristoires" ><img src="img/twitter.svg" alt="twitter logo" class="logo-social-footer logo-social-facebook-footer"/></a>
         <a href="https://www.facebook.com/terristoires.info" ><img src="img/facebook.svg" alt="facebook logo" class="logo-social-footer logo-social-twitter-footer"/></a>
      </div>
      
      <div class="small-12 medium-8 large-8 columns">
         <p class="content-footer">
         &copy; Nom prénom etc..
         </p>
      </div>
      
      <div class="small-12 medium-2 large-2 columns">
         <img src="img/footer-car.svg" alt="flying car" class="logo-car-footer"/>
      </div>
   
   </footer>
   
   <div style="display:none;">
      <a href="#" data-dropdown="drop" class="button dropdown">Dropdown Button</a><br> <ul id="drop" data-dropdown-content class="f-dropdown"> <li><a href="#">This is a link</a></li> <li><a href="#">This is another</a></li> <li><a href="#">Yet another</a></li> </ul>
      <span data-tooltip class="has-tip" title="Tooltips are awesome, you should totally use them!">extended information</span>
   </div>
  
  <script type="text/javascript"> 
  $(document).foundation({
     // specify the class used for active divs
     active_class: 'active',
     // how many pixels until the magellan bar sticks, 0 = auto
     threshold: 0,
     // pixels from the top of destination for it to be considered active
     destination_threshold: 20,
     // calculation throttling to increase framerate
     throttle_delay: 50,
     tooltips: {
      touch_close_text: 'appuyer pour fermer'
     }
  });
  
   // chargement des données pour la carte de france
   var map = new MapsFrance('#carteDeFrance');
   var page3Loaded =false;
   $('#page3').hover(function(){
      if(!page3Loaded) {
         page3Loaded = true;
         $.getJSON( "data/villes.json", function( dataVille ) {
            for(i=0;i<dataVille.length;i++) {
               map.addPoint(dataVille[i].latitude,dataVille[i].longitude,dataVille[i].nom);
            }
         });
      }
   },function() {});
   
   // chargement des diagrammes circulaires
   nbJeuxDonnees = new CanvasRenderer(document.getElementById('nb-jeux-donnees'));
   ratioJeuxDonnees = new CanvasRenderer(document.getElementById('ratio-jeux-donnees'));

   var dataGraph1 = new Object();
   var dataGraph2 = new Object();
   
   var choixVillesGraph = ["Nantes","Rennes","Paris","Bordeaux"];
   
   var page4Loaded = false;
   
   $('#page4').hover(function(){
      if(!page4Loaded) {
         page4Loaded = true;
         $.getJSON( "data/villes.json", function( data ) {
         
            nombreJeux = new Array();
            ratios = new Array();
            for(i=0;i<data.length;i++) {
               var position = $.inArray(data[i].nom,choixVillesGraph);
               if(position != -1){
                  nombreJeux[choixVillesGraph[position]] = data[i].jeuxDeDonnees;
                  var ratio = (Math.round(data[i].jeuxDeDonnees/data[i].population*100000*100))/100;
                  ratios[choixVillesGraph[position]] = ratio;
               }
            }
            
            // recherche des max
            maxNomJeux = 0;
            indiceMaxNomJeux = 0;
            maxRatios = 0;
            indiceMaxRatios = 0;
            for(i=0;i<choixVillesGraph.length;i++) {
               if(maxNomJeux < nombreJeux[choixVillesGraph[i]]) {
                  maxNomJeux = nombreJeux[choixVillesGraph[i]];
                  indiceMaxNomJeux = i;
               }
               if(maxRatios < ratios[choixVillesGraph[i]]) {
                  maxRatios = ratios[choixVillesGraph[i]];
                  indiceMaxRatios = i;
               }
            }
            
            // calcul des pourcentages
            dataGraph1.greenLine = nombreJeux[choixVillesGraph[0]]*100/nombreJeux[choixVillesGraph[indiceMaxNomJeux]];
            dataGraph1.whiteLine = nombreJeux[choixVillesGraph[1]]*100/nombreJeux[choixVillesGraph[indiceMaxNomJeux]];
            dataGraph1.redLine = nombreJeux[choixVillesGraph[2]]*100/nombreJeux[choixVillesGraph[indiceMaxNomJeux]];
            dataGraph1.yellowLine = nombreJeux[choixVillesGraph[3]]*100/nombreJeux[choixVillesGraph[indiceMaxNomJeux]];
            
            dataGraph2.greenLine = ratios[choixVillesGraph[0]]*100/ratios[choixVillesGraph[indiceMaxRatios]];
            dataGraph2.whiteLine = ratios[choixVillesGraph[1]]*100/ratios[choixVillesGraph[indiceMaxRatios]];
            dataGraph2.redLine = ratios[choixVillesGraph[2]]*100/ratios[choixVillesGraph[indiceMaxRatios]];
            dataGraph2.yellowLine = ratios[choixVillesGraph[3]]*100/ratios[choixVillesGraph[indiceMaxRatios]];
            
            // animation
            nbJeuxDonnees.animate(dataGraph1);
            ratioJeuxDonnees.animate(dataGraph2);
         });
         
      }
   
   },function() {});
   
   
   // chargement de la liste des villes
   var page5Loaded = false;
   var montab;
   $("#page5").hover(function () {
      if(!page5Loaded) {
         page5Loaded = true;
         $.ajax( "data/theme.csv" )
         .done(function(csv) {
            montab = csv2array(csv);
            genererdataviz(montab, 1, 2);
         });
         //var csv = '"critere", "ville1", "ville2", "ville3"\n"taille", 12.3, 20.3, 8.7\n"population", 40.5, 1.2, 50.6\n"transport", 80.5, 10.2, 50.6\n"taille", 12.3, 20.3, 8.7\n"population", 40.5, 1.2, 50.6\n"transport", 80.5, 10.2, 50.6\n';
      }
   }, function () {});
   
  </script>
  </body>
</html>
