<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>L'open data dans l'ouest</title>
    <link rel="stylesheet" href="css/foundation.css" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/style-carte.css" />
  </head>
  <body>
  
  <!-- NE PAS AJOUTER D'ÉlÉMENTS ICI -->
   <div data-magellan-expedition="fixed" id="menu-fixed" class="show-for-medium-up">
      <div class="row" style="width:100%;">
         <div class="columns large-9 medium-9 large-centered medium-centered">
            <dl class="sub-nav">
               <dd data-magellan-arrival="page1"><a href="#page1" data-tooltip class="has-tip tip-bottom" title="État des lieux de l'open data"> </a></dd>
               <dd data-magellan-arrival="page2"><a href="#page2" data-tooltip class="has-tip tip-bottom" title="L'open data en question"> </a></dd>
               <dd data-magellan-arrival="page3"><a href="#page3" data-tooltip class="has-tip tip-bottom" title="L'Open Data des métropoles françaises"> </a></dd>
               <dd data-magellan-arrival="page4"><a href="#page4" data-tooltip class="has-tip tip-bottom" title="Nombre de données disponibles"> </a></dd>
               <dd data-magellan-arrival="page5"><a href="#page5" data-tooltip class="has-tip tip-bottom" title="Comparateur de thématiques"> </a></dd>
               <dd data-magellan-arrival="page6"><a href="#page6" data-tooltip class="has-tip tip-bottom" title="Et l'ouest"> </a></dd>
               <dd data-magellan-arrival="page7"><a href="#page7" data-tooltip class="has-tip tip-bottom" title="Grand ouest"> </a></dd>
               <dd data-magellan-arrival="page8"><a href="#page8" data-tooltip class="has-tip tip-bottom" title="Interviews"> </a></dd>
               <dd data-magellan-arrival="page9"><a href="#page9" data-tooltip class="has-tip tip-bottom" title="L'open data en application"> </a></dd>
            </dl>
         </div>
      </div>
   </div>

   <a name="page1"></a>
   <div data-magellan-destination="page1" id="page1" class="page row bg-green">
      <div class="small-12 large-12 columns">
         <div id="main-title">
            <h1 class="title">open data</h1>
            <h3 class="title">où en est l'ouest ?</h3>
         </div>
      </div>
   </div>
   
   <a name="page2"></a>
   <div data-magellan-destination="page2" id="page2" class="page row bg-blue">
      <h2 class="title">l'open data en question</h2>
      
      <div class="small-12 medium-8 medium-centered large-8 large-centered columns">
         <div class="flex-video">
            <iframe src="//www.youtube.com/embed/p5xJKl-wBiU" width="420" height="315"  frameborder="0" allowfullscreen></iframe>
         </div>
      </div>
   </div>
   
   <a name="page3"></a>
   <div data-magellan-destination="page3" id="page3" class="page row bg-gray">
      <h2 class="title">l'Open Data des métropoles françaises</h2>
      <div class="small-12 medium-9 large-9 columns" id="carteDeFrance">
         <img src="img/carte-France-page3.svg" alt="maps of France"/>
      </div>
      <div class="small-12 medium-3 large-3 columns" id="side-page3">
         <p>Cliquer sur la ville pour obtenir plus d'information</p>
         <ul class="small-block-grid-2 medium-block-grid-1 large-block-grid-1">
            <li>
               <img src="img/pictogramme-nombre-d-habitant-page3.svg" alt="picture face of one people"/><br/>
               <span id="picto-nb-hab">0</span> habitants
            </li>
            <li>
               <img src="img/pictogramme-jeux-de-donnees-page3.svg" alt="chart"/><br/>
               <span id="picto-nb-jeux-donnees">0</span> jeux de données
            </li>
            <li>
               <img src="img/pictogramme-nombre-de-donnees-par-habitants-page3.svg" alt="two arrow"/><br/>
               <span id="picto-ratio-hab">0</span> jeux de données pour 100 000 habitant
            </li>
            <li>
               <img src="img/pictogramme-thematique-des jeux-de-donnees-page3.svg" alt="house with two tree"/><br/>
               <span id="picto-nb-hab">thématiques des jeux de données</span>
            </li>
         </ul>
      </div>
   </div>
   
   <a name="page4"></a>
   <div data-magellan-destination="page4" id="page4" class="page row bg-red">
      <div class="small-12 medium-11 medium-centered large-11 large-centered columns">
         <div class="row">
            <div class="small-12 medium-6 large-6 columns">
               <h2 class="title">nombre de jeux de données</h2>
               <div class="graphique" id="nb-jeux-donnees">
                  <div class="villes" id="ville-jdd">
                  </div>
               </div>
               <img src="img/ombre.svg" alt="shadow" class="shadow-page4 show-for-medium-up"/>
            </div>
            <div class="small-12 medium-6 large-6 columns">
               <h2 class="title">ratio de données pour 100 000 habitants</h2>
               <div class="graphique" id="ratio-jeux-donnees">
                  <div class="villes" id="ville-ratio">
                  </div>
               </div>
               <img src="img/ombre.svg" alt="shadow" class="shadow-page4 show-for-medium-up"/>
            </div>
         </div>
      </div>
   </div>
   
   <a name="page5"></a>
   <div  data-magellan-destination="page5" id="page5" class="page row bg-gray">
      <h2 class="title">thématiques des jeux de données</h2>

      <div class="small-12 medium-12 large-12 columns">
		
		   <table id="tableau-match" width="100%">
		   <tr>
			   <td id="nomVille1" align="right" style="width:41%"></td>
			   <td align="middle" style="width:18%"></td>
			   <td Id="nomVille2" align="left" style="width:41%"></td>
		   </tr>
		   </table>

		   <img src="img/ombre-plate.svg" alt="shadow" class="shadow-page5 show-for-medium-up"/>
		</div>
	</div>
   
   <a name="page6"></a>
   <div data-magellan-destination="page6" id="page6" class="page row bg-blue">
      <h1 class="title">et l'ouest ?<h1>
   </div>
   
   <a name="page7"></a>
   <div data-magellan-destination="page7" id="page7" class="page row bg-green">
		<h2 class="title">grand ouest</h2>
		<div class="small-12 large-6 medium-6 columns">
		   <H4 id="nomdepartementselection" style="middle"></H4>
	   	<div id="infodepartementselection" style="middle"></div>
			<div style="position:relative">
				<div style="position:absolute; top:4%; left:20%; ">
					
					<div style="position:absolute; top:0%; left:30%; ">
					
				</div>
				</div>
				
				<img id="departementselection" src="img/cotearmor.svg" width="50%" height="50%"/>
				<div id="infovilledepartementselection" style="middle"></div>
			</div>
		
		</div>

		
		<div class="small-12 large-6 medium-6 columns">

         <p style="font-weight:1.2em">
            cliquer sur les départements pour afficher les informations
         </p>
			<div class="map">
			<img src="img/vide.png" width="362" height="248" border="0" usemap="#mapouest" />


			<map name="mapouest">
			<area id="dep-1" shape="poly" coords="23,208,40,119,112,86,243,56,289,79,294,60,353,82,355,272,305,298,319,358,382,369,386,395,338,421,340,471,318,445,253,425,236,408,173,401,173,420,107,419,122,383,21,309,23,289,150,291,135,253,84,244,76,205,127,209,120,162" onclick="loadimageouest(0)" />
			<area  id="dep-2" shape="poly" coords="354,272,433,308,483,269,577,312,678,311,678,373,718,383,738,437,699,471,728,522,716,567,675,565,643,594,619,592,604,571,524,577,545,546,526,519,492,534,451,535,448,571,428,558,433,519,384,470,339,472,337,419,387,390,383,370,318,357,305,299,352,273" onclick="loadimageouest(1)" />
			<area  id="dep-3" shape="poly" coords="356,272,353,80,378,26,401,32,486,15,560,123,600,144,679,108,725,162,730,127,789,165,777,218,677,311,571,307,482,271,433,310,358,273" onclick="loadimageouest(2)" />
			<area  id="dep-4" shape="poly" coords="788,162,777,221,674,316,678,373,719,379,742,433,704,468,727,523,846,495,900,455,951,435,970,400,1010,391,1015,190,969,163,925,194,899,130,831,151,804,129,811,106,764,117,765,151,783,160" onclick="loadimageouest(3)" />
			<area  id="dep-5" shape="poly" coords="727,522,711,566,671,566,643,594,716,620,703,663,767,694,826,751,872,750,860,709,874,693,896,736,910,717,909,698,978,691,945,672,954,639,919,601,949,582,1020,592,1005,514,966,480,953,433,851,495,747,518" onclick="loadimageouest(4)" />
			<area  id="dep-6" shape="poly" coords="765,695,725,728,690,696,681,710,715,748,702,764,786,842,786,895,943,963,996,934,1002,946,1020,942,1063,960,1092,939,1071,921,1069,886,1094,849,1069,786,1022,720,946,696,911,696,910,720,894,735,877,697,862,710,875,750,822,750,809,732" onclick="loadimageouest(5)" />
			<area  id="dep-7" shape="poly" coords="921,603,952,634,948,670,971,691,943,693,1017,720,1030,735,1051,726,1097,723,1099,705,1124,696,1200,693,1214,704,1231,696,1301,541,1297,522,1157,452,1021,435,1020,454,957,437,964,481,1006,513,1019,591,959,581,942,588" onclick="loadimageouest(6)" />
			<area  id="dep-8" shape="poly" coords="1012,189,1014,393,977,402,952,433,1017,454,1021,435,1157,449,1213,296,1207,250,1246,239,1246,220,1192,179,1074,209,1066,188,1033,189" onclick="loadimageouest(7)" />
			<area  id="dep-9" shape="poly" coords="1158,451,1295,519,1333,526,1453,397,1453,324,1420,296,1392,293,1345,260,1338,258,1338,218,1314,205,1268,237,1210,251,1215,289,1183,377" onclick="loadimageouest(8)" />
			</map>

			
			</div>
		</div>

	</div>
   
   <a name="page8"></a>
   <div data-magellan-destination="page8" id="page8" class="page row bg-red">
      <h2 class="title">interviews</h2>
      
      <div class="small-12 medium-9 medium-centered large-9 large-centered columns">
      
         <dl class="accordion" id="page8-accordion" data-accordion> 
            <dd>
               <a href="#panel1">Aller vers une plus grande ouverture</a> 
               <div id="panel1" class="content active vide">
                  <div class="flex-video">
                     <iframe src="//www.youtube.com/embed/kQbtz7zlTUw" width="420" height="315"  frameborder="0" allowfullscreen></iframe>
                  </div>
                  <p>
                     Claire Gallon, cofondatrice de l'association LiberTIC qui promeut l'ouverture des données en France, revient sur le mouvement Open data dans l'Ouest.
                  </p>
               </div>
            </dd>
            <dd>
               <a href="#panel2">Promouvoir l'Open Data auprès des citoyens</a>
               <div id="panel2" class="content vide">
               <p>
<h5>Quels sont les usages des données ouvertes ?</h5>

"Il y a au moins quatre usages possibles des données ouvertes : la consultation (par exemple consulter directement une donnée brute pour savoir combien il y a de policiers municipaux dans ma ville), la médiation (comme réaliser une datavisualisation), la réalisation d'applications mobiles ou web (telles que des applications iPhone), la réutilisation spécialisée (par exemple quand une entreprise ou un particulier utilise une donnée pour faire un calcul ou améliorer un processus)."<br>

<h5>Pensez-vous que cela puisse intéresser les citoyens ?</h5>

"Bien sûr, selon les thématiques qui sont traitées par les données. Par exemple, les données concernant les prénoms les plus populaires sont très consultées sur les portails Data. 
Il faut cependant mettre en place des dispositifs qui permettent aux citoyens de découvrir les données et de ses les approprier. Les lieux de type 'Infolab' peuvent être dédiés à cela, vous pouvez vous référer à mon article de blog sur ce sujet : <a href="http://donneesouvertes.info/2012/10/11/lopen-data-et-le-grand-public-on-nattrape-pas-les-mouches-avec-du-vinaigre/">"L'Open Data et le grand public, on n’attrape pas les mouches avec du vinaigre".</a>"<br>

<h5>Quelles sont les données, les thématiques qui intéressent le plus ?</h5>

"Cela dépend du type de réutilisateurs. Les développeurs et les profils techniques sont très intéressés par les données liées aux transports et aux déplacements (horaires de bus, disponibilité en temps réel des vélos en libre-service, etc.). Les datajournalistes s'intéressent plutôt aux données statistiques ou budgétaires, par exemple <a href="https://www.google.com/fusiontables/DataSource?docid=1xvJwLapFYwAzTMAfGyVrHgNXWukY5VI7UUwUfn4#map:id=3">le classement des 100 premières polices municipales de France</a>, <a href="http://www.data-projet.com/carte-accident-29">la localisation des accidents de la route</a>, ou encore <a href="http://www.liberation.fr/economie/2014/01/29/budget-de-l-etat-ou-economiser-des-milliards_976108">la représentation du budget de l'État</a>. Tout cela peut être réalisé à partir des données ouvertes publiées par les collectivités et l'Etat.
Enfin, le citoyen s'intéresse davantage aux données liées à sa commune ou à sa vie quotidienne : par exemple les prénoms les plus populaires, la liste des associations subventionnées, et tout ce qui concerne le patrimoine (bâtiments historiques, etc...)."<br>

<h5>Que faudrait-il faire pour améliorer la démarche Open Data ?</h5>

"Il faudrait encourager l'interaction entre les producteurs (ceux qui produisent de la donnée, acteurs publics et privés) et les réutilisateurs de données.
De plus, mettre en place des lieux et des parcours dédiés à la donnée, des Infolabs sur le modèle des Fablabs, ainsi que mieux faire connaître l'offre de données qui existe déjà en ligne."<br>
</p>
               </div>
            </dd>
            <dd>
               <a href="#panel3">La démarche Open Data à Nantes</a>
               <div id="panel3" class="content vide">
<p>       
Interview d'Alexandre Cherré, community manager à Nantes Métropole.<br>

<h5>Est-ce que l'Open Data a été difficile à mettre en place dans votre collectivité ?</h5>

"L’Open Data nantais a démarré sous l’impulsion de Jean-Marc Ayrault en 2011 en lien avec l’association Libertic. L'objectif était d’améliorer les services aux habitants et de faciliter le développement d’applications innovantes. Une organisation dédiée a été mise en place afin de permettre l’ouverture d’une première version de la plateforme en quelques mois.
Si Nantes n’était pas la première collectivité à ouvrir ses données, le sujet demeurait neuf et plusieurs questions, dont certaines exigeaient une réelle expertise, devaient être débattues : le choix de la licence sous laquelle les données seraient ouvertes, la question de la facturation ou de la gratuité des données libérées, le contrôle éventuel de la fiabilité des réutilisations, le choix ou non d’orienter les données ouvertes vers des services dont l’intérêt était préalablement identifié par la collectivité et les choix d’animation de la communauté de réutilisateurs (travail en coproduction avec l’association LiberTIC).
À cela s’ajoutait la mise en œuvre d’un mode de pilotage adéquat permettant d’associer la Direction Générale et les directions compétentes sur les divers sujets concernés (informatique, communication, innovation, promotion, thématiques)."

<h5>Quels sont les usages des données libérées ?</h5>

"Les données libérées par Nantes l’ont été selon 3 thématiques prioritaires : la mobilité en liaison avec l’optimisation de la politique de déplacements sur l’agglomération, l’environnement avec Nantes Capitale Verte 2013, la culture et le tourisme en association avec les événements Voyage à Nantes.
À ces trois thématiques prioritaires initialement définies est venue s’ajouter celle du budget que Nantes a ouvert dès 2012.
L’appel à projets « Rendez-moi la ville plus facile » organisé en 2012 par Nantes a permis de se rendre compte de la diversité des réutilisations possibles puisque 121 dossiers de candidatures avaient été déposés à cette occasion (dont 52 % en provenance des particuliers et des associations, 26 % d’entreprises et 22 % d’étudiants).
Les principales réutilisations connues par nos services concernent principalement les données de mobilité, notamment grâce à des développements d’applications mobiles (Statiophone, Naoned Bus, Open Nantes). Elles s’appuient en général sur les flux de données mis à jour en temps réel sur la plateforme Open Data qui donnent le nombre de places disponibles dans les parkings publics, des temps de parcours sur des tronçons de l’agglomération ou encore des informations de fluidité du trafic routier."<br>

<h5>Pensez-vous que cela puisse intéresser les citoyens ?</h5>

"L’ouverture des données permet de développer le tissu économique local et d’améliorer les services rendus aux usagers et entreprises du territoire. L’objectif de la démarche Open Data est un choix politique et répond à un enjeu de transparence et une certaine conception de coconstruction de la ville : la transmission, le partage et la réutilisation de ces données dématérialisées favorisent, à terme, l’innovation et l’activité tout en améliorant la vie quotidienne des habitants. Il est vrai que le <a href="http://data.nantes.fr">portail Open Data</a> ne connaît pas l’affluence d’un site grand public. Toutefois, le forum mis à disposition, les événements organisés autour de la démarche et le nombre de services développés laisse à penser que cette démarche intéresse de plus en plus les citoyens. Les récentes ouvertures de données sur les résultats des précédents scrutins électoraux à Nantes ou sur les bureaux de vote alimentent par exemple les travaux d’associations, de collectifs et de citoyens dans la perspective du prochain scrutin municipal."<br>

<h5>Quelles sont les données, les thématiques qui intéressent le plus ?</h5>

"Les données les plus téléchargées sont celles de la thématique ‘Mobilité’ (localisation des équipements publics, services – horaires - tarifs, données TAN), et plus particulièrement les flux de données temps réel qui se prêtent bien au développement de services mobiles innovants. Mais les données ouvertes dans la thématique ‘Environnement’ suscitent également de nombreux accès (déchèteries, jours de collecte des déchets, tri’sac)."<br>

<h5>Qu'est-ce qu'il faudrait faire pour améliorer la démarche Open Data ?</h5>

"Les pistes d’amélioration de la démarche Open Data sont les suivantes : développer d’avantage l’ouverture des données auprès du plus grand nombre de villes, métropole et collectivités locales, améliorer l’interopérabilité des données ouvertes par différents acteurs du territoire afin que les services développés aient une portée qui ne soit pas uniquement locale, renforcer les animations autour des données libérées sur le territoire et les relations avec les réutilisateurs de nos données, répondre plus efficacement aux demandes des citoyens et optimiser les circuits de production et de mise à jour des données, pérenniser les applications et les services développés autour des données ouvertes (modèle économique à trouver)."<br>

<h5>Et concrètement quelles est votre mission aujourd'hui ?</h5>

"C’est dans ce contexte que Nantes Métropole et la Ville de Nantes font partie des membres fondateurs de la récente association Open Data France (http://opendatafrance.net) dont la mission est de regrouper et soutenir les collectivités engagées activement dans une démarche d’ouverture des données publiques et de favoriser toutes les démarches entreprises par ces collectivités dans le but de la promotion de l’open data en France."<br>

A noter que le portail Open data a valu aux collectivités le prix Gazette des Communes, remis en novembre dernier.﻿</p>
               </div>
            </dd>
         </dl>
      </div>
   </div>
   
   <a name="page9"></a>
   <div data-magellan-destination="page9" id="page9" class="page row bg-blue">
   
      <h2 class="title">l'open data en application</h2>
      <div class="small-12 medium-5 large-5 columns">
         <a href="http://www.rengo.fr/rennes/">
            <img src="img/logo_rengo.png" alt="rengo logo"/>
         </a>
         <p>
            application mobile gratuite qui indique en temps réel les horaires et disponibilités de nombreux services de transports rennais (trains, bus, vélos, parkings, etc.). Cette application est également disponible pour les villes de Nantes, Bordeaux, Strasbourg...
         </p>
         
         <a href="https://play.google.com/store/apps/details?id=net.naonedbus&hl=fr">
            <img src="img/logo_naonedbus.png" alt="naoned bus logo"/>
         </a>
         <p>
            application mobile gratuite pour Android permettant de consulter les horaires des transports nantais (réseau Tan, disponibilité des bicloos et parkings de la ville).
         </p>
      </div>
      <div class="large-2 medium-2 columns">
      </div>
      <div class="small-12 medium-5 large-5 columns">
      
         <a href="http://foglo.fr">
            <img src="img/logo_foglo.png" alt="foglo logo"/>
         </a>
         <p>
            application web gratuite et nantaise qui fournit aux utilisateurs un tableau de bord regroupant divers services (météo, Tan, parkings, qualité de l'air, twitter, facebook, rss, ...).
         </p>

         <a href="http://www.handimap.org/">
            <img src="img/logo_handimap.png" alt="handimap.org logo"/>
         </a>
         <p>
            application web gratuite qui permet de calculer des itinéraires accessibles aux personnes à mobilité réduite dans la ville de Rennes (ainsi que Montpellier).
         </p>
      </div>
   </div>
   
   <footer class="row bg-gray">
      <div class="small-12 medium-2 large-2 columns">
         <a href="https://twitter.com/terristoires" ><img src="img/twitter.svg" alt="twitter logo" class="logo-social-footer logo-social-facebook-footer"/></a>
         <a href="https://www.facebook.com/terristoires.info" ><img src="img/facebook.svg" alt="facebook logo" class="logo-social-footer logo-social-twitter-footer"/></a>
      </div>
      
      <div class="small-12 medium-8 large-8 columns">
         <p class="content-footer">
        Terri(s)toires :

Capucine Saez 
journaliste et coordinatrice 
<br>
SciencesCom :

Anne-Lise Vinet
journaliste et coordinatrice

Marguerite de Crécy
journaliste

Élise Béthus
journaliste

Sophie Frappier
journaliste

<br>
Polytech'Nantes :

Florent Guillemot
développeur

Vladimir Bagazov
développeur

<br>
AGR :

Flavien Fruneau
graphiste

Paul Le Grix
graphiste﻿
         </p>
      </div>
      
      <div class="small-12 medium-2 large-2 columns">
         <img src="img/footer-car.svg" alt="flying car" class="logo-car-footer"/>
      </div>
   
   </footer>
   
   <div style="display:none;">
      <a href="#" data-dropdown="drop" class="button dropdown">Dropdown Button</a><br> <ul id="drop" data-dropdown-content class="f-dropdown"> <li><a href="#">This is a link</a></li> <li><a href="#">This is another</a></li> <li><a href="#">Yet another</a></li> </ul>
      <span data-tooltip class="has-tip" title="Tooltips are awesome, you should totally use them!">extended information</span>
   </div>
  
   <script src="js/vendor/modernizr.js"></script>
    <script src="js/vendor/jquery.js"></script>
    <script src="js/vendor/jquery.scrollto.js"></script>
    <script src="js/foundation/foundation.js"></script>
    <script src="js/foundation/foundation.dropdown.js"></script>
    <script src="js/foundation/foundation.tooltip.js"></script>
    <script src="js/foundation/foundation.magellan.js"></script>
    <script src="js/foundation/foundation.accordion.js"></script>
    <!-- Partie du fait maison -->
    <script src="js/vendor/round-chart.js"></script>
    <script src="js/vendor/maps-france.js"></script>
    <script src="js/csv-match.js"></script>
    <script src="js/carteouest.js"></script>
  <script type="text/javascript"> 
   $(document).foundation({
     // specify the class used for active divs
     active_class: 'active',
     // how many pixels until the magellan bar sticks, 0 = auto
     threshold: 0,
     // pixels from the top of destination for it to be considered active
     destination_threshold: 20,
     // calculation throttling to increase framerate
     throttle_delay: 50
   });

   // hack de foundation sans passer par sass
   $('.content').css('background-color','#f09ba0');
   $('.content a').css('background-color','#f09ba0');
   $('#menu-index:eq(2)').css({
      'display':'none',
      'opacity':'0'
   });
   // barre qui bouge
   $('#menu-index:eq(1)').css({
      'margin':'auto',
      'display':'block',
      'background-color':'#cbe3cb'
   });
   
   // chargement des données pour la carte de france
   var map = new MapsFrance('#carteDeFrance');
   var page3Loaded =false;
   $('#page3').hover(function(){
      if(!page3Loaded) {
         page3Loaded = true;
         $.getJSON( "data/villes.json", function( dataVille ) {
            for(i=0;i<dataVille.length;i++) {
               map.addPoint(dataVille[i].latitude,dataVille[i].longitude,dataVille[i].nom);
            }
         });
      }
   },function() {});
   
   // chargement des diagrammes circulaires
   nbJeuxDonnees = new CanvasRenderer(document.getElementById('nb-jeux-donnees'));
   ratioJeuxDonnees = new CanvasRenderer(document.getElementById('ratio-jeux-donnees'));

   var dataGraph1 = new Object();
   var dataGraph2 = new Object();
   
   var choixVillesGraph = ["Nantes","Rennes","Paris","Bordeaux"];
   
   var page4Loaded = false;
   
   $('#page4').hover(function(){
      if(!page4Loaded) {
         page4Loaded = true;
         $.getJSON( "data/villes.json", function( data ) {
         
            nombreJeux = new Array();
            ratios = new Array();
            for(i=0;i<data.length;i++) {
               var position = $.inArray(data[i].nom,choixVillesGraph);
               if(position != -1){
                  nombreJeux[choixVillesGraph[position]] = data[i].jeuxDeDonnees;
                  var ratio = (Math.round(data[i].jeuxDeDonnees/data[i].population*100000*100))/100;
                  ratios[choixVillesGraph[position]] = ratio;
               }
            }
            
            // écriture des villes
            for(i=0;i<choixVillesGraph.length;i++) {
               $('#ville-jdd').append('<span class="ville">'+choixVillesGraph[i]+'</span> '+nombreJeux[choixVillesGraph[i]]+'<br>');
            }
            
            for(i=0;i<choixVillesGraph.length;i++) {
               $('#ville-ratio').append('<span class="ville">'+choixVillesGraph[i]+'</span> '+ratios[choixVillesGraph[i]]+'<br>');
            }
            
            
            // recherche des max
            maxNomJeux = 0;
            indiceMaxNomJeux = 0;
            maxRatios = 0;
            indiceMaxRatios = 0;
            for(i=0;i<choixVillesGraph.length;i++) {
               if(maxNomJeux < nombreJeux[choixVillesGraph[i]]) {
                  maxNomJeux = nombreJeux[choixVillesGraph[i]];
                  indiceMaxNomJeux = i;
               }
               if(maxRatios < ratios[choixVillesGraph[i]]) {
                  maxRatios = ratios[choixVillesGraph[i]];
                  indiceMaxRatios = i;
               }
            }
            
            // calcul des pourcentages
            dataGraph1.greenLine = nombreJeux[choixVillesGraph[0]]*100/nombreJeux[choixVillesGraph[indiceMaxNomJeux]];
            dataGraph1.whiteLine = nombreJeux[choixVillesGraph[1]]*100/nombreJeux[choixVillesGraph[indiceMaxNomJeux]];
            dataGraph1.redLine = nombreJeux[choixVillesGraph[2]]*100/nombreJeux[choixVillesGraph[indiceMaxNomJeux]];
            dataGraph1.yellowLine = nombreJeux[choixVillesGraph[3]]*100/nombreJeux[choixVillesGraph[indiceMaxNomJeux]];
            
            // graph 2
            dataGraph2.greenLine = ratios[choixVillesGraph[0]]*100/ratios[choixVillesGraph[indiceMaxRatios]];
            dataGraph2.whiteLine = ratios[choixVillesGraph[1]]*100/ratios[choixVillesGraph[indiceMaxRatios]];
            dataGraph2.redLine = ratios[choixVillesGraph[2]]*100/ratios[choixVillesGraph[indiceMaxRatios]];
            dataGraph2.yellowLine = ratios[choixVillesGraph[3]]*100/ratios[choixVillesGraph[indiceMaxRatios]];
            
            // animation
            nbJeuxDonnees.animate(dataGraph1);
            ratioJeuxDonnees.animate(dataGraph2);
         });
         
      }
   
   },function() {});
   
   
   // chargement de la liste des villes
   $.ajax( "data/theme.csv" )
   .done(function(csv) {
      montab = csv2array(csv);
      genererdataviz(montab, 1, 2);
   });
   
   
   
  </script>
  </body>
</html>
